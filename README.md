# KYBarrageKit
è¿™æ˜¯ä¸€ä¸ªiOSé«˜æ‰©å±•çš„å¼¹å¹•æ¸²æŸ“åº“ï¼Œé€‚ç”¨å¤§å¤šæ•°ç›´æ’­ç±»å¼¹å¹•åœºæ™¯ã€‚

# åŸå› 
å…¬å¸æ˜¯åšç›´æ’­ç”µå•†å¹³å°çš„ï¼Œäº§å“éœ€è¦åœ¨ç›´æ’­ç•Œé¢æœ‰å¼¹å¹•æ•ˆæœï¼Œè¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„åŠ¨ç”»æ•ˆæœï¼Œæ ¹æ®äº§å“æä¾›çš„éœ€è¦ï¼Œç»“åˆç½‘ä¸Šçš„ä¸€äº›å¼€æºé¡¹ç›®ï¼Œè‡ªå·±é€ äº†è½®å­ï¼Œå†™ä¸€ä¸ªç›´æ’­ç±»å¼¹å¹•æ¸²æŸ“åº“ï¼Œä»¥æ¥æ»¡è¶³æˆ‘ä»¬äº§å“å¤šå˜çš„åŠŸèƒ½éœ€æ±‚ã€‚

# ç‰¹å¾
* æ”¯æŒå¼¹å¹•çš„4ä¸ªæ–¹ä½æ»šåŠ¨æ–¹å‘ï¼›
* è‡ªå®šä¹‰å¼¹å¹•çš„æ»šåŠ¨é€Ÿåº¦ï¼›
* å¼¹å¹•ä¿¡æ¯ä¸º`NSMutableAttributedString`ç±»å‹ï¼Œæ”¯æŒå›¾ç‰‡å’Œæ–‡å­—å¼¹å¹•ï¼Œemojiè¡¨æƒ…ç¬¦å·ç­‰ï¼›
* å½“æ˜¯å¼¹å¹•ä¸º`KYBarrageDisplayTypeImage`ç±»å‹æ˜¯ï¼Œæ”¯æŒå¼¹å¹•è‡ªå®šä¹‰é«˜åº¦ï¼›
* å¼¹å¹•çš„ç±»å‹å¯ä»¥æ‰©å±•è‡ªå®šä¹‰ï¼ˆç›®å‰æ”¯æŒçº¯æ–‡æœ¬å’Œå›¾æ–‡ï¼‰ï¼›
* é‡‡ç”¨`CABasicAnimation`å®ç°æ¥å¼¹å¹•åŠ¨ç”»æ•ˆæœï¼›
* æ”¯æŒæ‰¹é‡ä¸»åŠ¨å‘é€å¼¹å¹•ï¼Œå¼¹å¹•çš„æš‚åœï¼Œæ¸…é™¤ï¼Œé‡å¯ï¼Œå¼€å§‹ç­‰ï¼›
* æ”¯æŒå¼¹å¹•å†…å­˜é¢„è­¦ï¼Œæ¸…é™¤å¼¹å¹•ç¼“å†²æ± ã€‚

å®ç°ä¸€äº›åŸºç¡€åŠŸèƒ½ï¼Œæ›´å¤šçš„åŠŸèƒ½åç»­å®Œå–„ä¸­......

æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

# åé¦ˆ


*  å¦‚æœéœ€è¦å¸®åŠ©ï¼Œå¯ä»¥ä½¿ç”¨**QQ:** 362108564è”ç³»æˆ‘ æˆ–**weibo:** [http://weibo.com/balenn](http://weibo.com/balenn) ç•™è¨€.
* å¦‚æœä½ å‘ç°äº†ä¸€ä¸ªbugï¼Œæ‰“å¼€ä¸€ä¸ª **issue**.
* å¦‚æœæ‚¨æœ‰ä¸€ä¸ªåŠŸèƒ½è¯·æ±‚ï¼Œè¯·æ‰“å¼€ä¸€ä¸ª **issue**.
* å¦‚æœæ‚¨æƒ³è´¡çŒ®ï¼Œè¯·æäº¤ä¸€ä¸ªè¯·æ±‚.

å¦‚æœæœ‰ä»»ä½•ä½ è§‰å¾—ä¸å¯¹çš„åœ°æ–¹ï¼Œæˆ–æœ‰æ›´å¥½çš„å»ºè®®ï¼Œä»¥ä¸Šè”ç³»éƒ½å¯ä»¥è”ç³»æˆ‘ã€‚ ååˆ†æ„Ÿè°¢ï¼


# å®‰è£…
### è¦æ±‚

* Xcode 7 +
* iOS 7.0 +

### æ‰‹åŠ¨å®‰è£…

å…ˆ[ä¸‹è½½é¡¹ç›®](https://github.com/kingly09/KYBarrageKit.git)å,å°†å­æ–‡ä»¶å¤¹ **KYBarrageKit** æ‹–å…¥åˆ°é¡¹ç›®ä¸­, å¯¼å…¥å¤´æ–‡ä»¶`KYBarrageKit.h` å¼€å§‹ä½¿ç”¨.

### CocoaPodså®‰è£…

ä½ å¯ä»¥åœ¨ **Podfile** ä¸­åŠ å…¥ä¸‹é¢ä¸€è¡Œä»£ç æ¥ä½¿ç”¨ **KYBarrageKit**

```
	pod 'KYBarrageKit'
```

ä½¿ç”¨ `cocoaPods` ç®¡ç†ç¬¬ä¸‰æ–¹åº“ï¼Œ å¦‚æœç”µè„‘æ²¡æœ‰å®‰è£… `cocoapods`ï¼Œè¯·å…ˆå®‰è£… `cocoapods`ã€‚å®‰è£…æ–¹å¼å¯å‚è€ƒï¼š[æœ€æ–°çš„cocoapodså®‰è£…] (http://blog.sina.com.cn/s/blog_6ff6523d0102x8dq.html)

# ä½¿ç”¨

* åœ¨éœ€è¦ä½¿ç”¨å¼¹å¹•æ¸²æŸ“åŠŸèƒ½çš„åœ°æ–¹
 
 ``` 
  #import â€œKYBarrageKitâ€
 ```
 
* åˆ›å»ºä¸€ä¸ª `KYBarrageManager *manager` å¯¹è±¡ï¼Œå¹¶å°†å…¶ view add åˆ°ä½ æƒ³è¦æ·»åŠ å¼¹å¹•åŠ¨ç”»çš„ view ä¸Šï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºï¼š

```
@interface ViewController ()
@property (strong, nonatomic) KYBarrageManager *manager;

@end

@implementation ViewController

- (void)viewDidLoad {
  [super viewDidLoad];
  // Do any additional setup after loading the view, typically from a nib.
   self.view.backgroundColor = [UIColor whiteColor];
    _manager = [KYBarrageManager manager];
    _manager.bindingView = self.view;
    _manager.scrollSpeed = 30;     
    _manager.refreshInterval = 1.0;  
}
```

* å‘é€ä¸€ä¸ªå¼¹å¹• 
 
```
int a = arc4random() % 100000;
    NSString *str = [NSString stringWithFormat:@"I'm coming %d ",a];
    
    NSMutableAttributedString *attr = [[NSMutableAttributedString alloc] initWithString:str];
    [attr addAttribute:NSForegroundColorAttributeName value:RandomColor() range:NSMakeRange(0, str.length)];
    
    KYBarrageModel *m = [[KYBarrageModel alloc] initWithBarrageContent:attr];
    [_manager showBarrageWithDataSource:m]; // Scroll Barrage 
```

* è®¾ç½®å¼¹å¹•æ˜¾ç¤ºåŒºåŸŸï¼Œæ”¯æŒå››ä¸ªæ–¹å‘ï¼Œé»˜è®¤ä¸º `KYBarrageDisplayLocationTypeDefault` æ•´ä¸ªæ˜¾ç¤ºåŒºåŸŸ

å…¨å±€è®¾ç½®

```

_manager.displayLocation = KYBarrageDisplayLocationTypeTop;  
 
```
æˆ– å½“ä¸ªå­å¼¹å¹•è®¾ç½®
 
```
   KYBarrageModel *m = [[KYBarrageModel alloc] initWithBarrageContent:attr];
    m.displayLocation       = _manager. KYBarrageDisplayLocationTypeTop;
 
```

æ”¯æŒæ˜¾ç¤ºåŒºåŸŸå¯¹åº”`NSInteger`çš„æšä¸¾:

KYBarrageDisplayLocationType        | value| note 
----------------------------------- | -----| -------------
KYBarrageDisplayLocationTypeDefault  | 0   |  æ•´ä¸ªæ˜¾ç¤ºåŒºåŸŸ
KYBarrageDisplayLocationTypeTop      | 1   |  é¡¶éƒ¨éƒ¨åˆ†
KYBarrageDisplayLocationTypeCenter   | 2   |  ä¸­é—´éƒ¨åˆ†
KYBarrageDisplayLocationTypeBottom   | 3   |  åº•éƒ¨éƒ¨åˆ†
KYBarrageDisplayLocationTypeHidden   | 4   |  ä¸æ˜¾ç¤º

* è®¾ç½®å¼¹å¹•æ˜¾ç¤ºä½ç½®ï¼Œæ”¯æŒå››ä¸ªæ–¹å‘ã€‚

å…¨å±€è®¾ç½®

```

_manager.scrollDirection = KYBarrageScrollDirectRightToLeft;  
 
```
æˆ– å½“ä¸ªå­å¼¹å¹•è®¾ç½®
 
```
   KYBarrageModel *m = [[KYBarrageModel alloc] initWithBarrageContent:attr];
    m.direction       = _manager.scrollDirection;
 
```
æ”¯æŒå››ä¸ªæ–¹å‘å¯¹åº”`NSInteger`çš„æšä¸¾:

KYBarrageScrollDirection            | value| note 
----------------------------------- | -----| -------------
KYBarrageScrollDirectRightToLeft    | 0   |  <<<<< 
KYBarrageScrollDirectLeftToRight    | 1   |  >>>>>
KYBarrageScrollDirectBottomToTop    | 2   |  â†‘â†‘â†‘â†‘â†‘
KYBarrageScrollDirectTopToBottom    | 3   |  â†“â†“â†“â†“â†“



* ä¸»åŠ¨æ‹‰å–å¼¹å¹•æ•°æ®å‘å¼¹å¹•ï¼Œè®¾ç½® `KYBarrageManagerDelegate` å§”æ‰˜ï¼Œè°ƒç”¨`-delegate barrageManagerDataSource`è¿”å›æ•°æ®

è®¾ç½®ä»£ç†å§”æ‰˜

```
 _manager.delegate = self;
 [_manager startScroll]; //å¼€å¯ä¸»åŠ¨è·å–å¼¹å¹•
```

è°ƒç”¨æ–¹æ³•

```
- (id)barrageManagerDataSource {
    
    int a = arc4random() % 10000;
    NSString *str = [NSString stringWithFormat:@"%d digg",a];
    
    NSMutableAttributedString *attr = [[NSMutableAttributedString alloc] initWithString:str];
    [attr addAttribute:NSForegroundColorAttributeName value:RandomColor() range:NSMakeRange(0, str.length)];
    
    KYBarrageModel *m = [[KYBarrageModel alloc] initWithBarrageContent:attr];
    m.displayLocation = _manager.displayLocation;
    m.direction       = _manager.scrollDirection;
    m.barrageType = KYBarrageDisplayTypeImage;
    m.object = [UIImage imageNamed:[NSString stringWithFormat:@"digg_%d",arc4random() % 10]];
    return m;
}
```

* è®¾ç½®æ¸…é™¤å¼¹å¹•ã€‚

```
[_manager closeBarrage];
```

* è®¾ç½®å¼¹å¹•çš„æš‚åœä¸æ¢å¤ã€‚

 ``` 
    // 1. åœ¨å±å¹•ä¸Šçš„é˜»å¡è¢«æš‚åœï¼Œåœæ­¢è·å–æ–°çš„é˜»å¡
    // 2. å½“å‰çš„å±å¹•ä¸Šçš„å¼¹å¹•é‡æ–°æ»šåŠ¨ï¼Œå¹¶è·å¾—ä¸€ä¸ªå¼€å§‹çš„æ–°å¼¹å¹•æ¨é€
    [_manager pauseScroll];
 ```

* è®¾ç½®å¼¹å¹•çš„ç±»å‹ç›®å‰æ”¯æŒçº¯æ–‡æœ¬`KYBarrageDisplayTypeDefault` å’Œå›¾æ–‡`KYBarrageDisplayTypeImage`ï¼Œå¯ä»¥åœ¨ `KYBarrageScene`è‡ªå®šä¹‰å…¶ä»–çš„ç±»å‹ã€‚

 ```
 m.barrageType = KYBarrageDisplayTypeImage;
 ```
 
# å…¶ä»–

æ”¯æŒå¼¹å¹•çš„ç‚¹å‡»äº‹ä»¶ 


å¦‚æœå¼¹å¹•ä¸º`KYBarrageDisplayTypeImage`å‹çš„å¼¹å¹•æ—¶ï¼Œè¯·é‡å†™`ViewController`çš„ `touchesBegan` æ–¹æ³•

```
- (void)touchesBegan:(NSSet<UITouch *> *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self.view];
    [[_manager barrageScenes] enumerateObjectsUsingBlock:^(BarrageScene * _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) {
        if ([obj.layer.presentationLayer hitTest:touchPoint]) {
           /* if barrage's type is ` `KYBarrageDisplayTypeImage` `, add your code here*/
            NSLog(@"message = %@",obj.model.message.string);
        }
    }];
}
```

å¦‚DEMOé‡Œé¢çš„ç‚¹å‡»å¼¹å¹•ï¼Œå¼¹å¹•åœé¡¿3såï¼Œè¿›è¡Œæ»šåŠ¨ï¼Œä¹Ÿå¯ä»¥æ‰©å±•å…¶ä»–äº‹ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š



# é¼“åŠ±

å®ƒè‹¥ä¸æ…ç»™æ‚¨å¸®åŠ©ï¼Œè¯·ä¸åå•¬ç»™å®ƒç‚¹ä¸€ä¸ª**star**ï¼Œæ˜¯å¯¹å®ƒçš„æœ€å¥½æ”¯æŒï¼Œéå¸¸æ„Ÿè°¢ï¼ğŸ™

# LICENSE

**KYBarrageKit** è¢«è®¸å¯åœ¨ **MIT** åè®®ä¸‹ä½¿ç”¨ã€‚æŸ¥é˜… **LICENSE** æ–‡ä»¶æ¥è·å¾—æ›´å¤šä¿¡æ¯ã€‚




